<!-- <xml version="1.0"> -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org" />

  <title>Export Org mode documents to HTML, PDF, etc.</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Org-mode" />
  <meta name="author" content="Fabrice Niessen" />
  <link rel="stylesheet" type="text/css" href=
  "http://www.pirilampo.org/styles/bigblow/css/htmlize.css" />
  <link rel="stylesheet" type="text/css" href=
  "http://www.pirilampo.org/styles/bigblow/css/bigblow.css" />
  <link rel="stylesheet" type="text/css" href=
  "http://www.pirilampo.org/styles/bigblow/css/hideshow.css" />
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery-1.9.1.min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/bigblow.js">
</script>
<script type="text/javascript" src=
"http://www.pirilampo.org/styles/bigblow/js/hideshow.js">
</script>
</head>

<body>
  <div id="content">
    <h1 class="title">Export Org mode documents to HTML, PDF, etc.</h1>

    <div id="outline-container-sec-1" class="outline-2">
      <h2 id="sec-1"><span class="section-number-2">1</span> Overview</h2>

      <div class="outline-text-2" id="text-1"></div>

      <div id="outline-container-sec-1-1" class="outline-3">
        <h3 id="sec-1-1"><span class="section-number-3">1.1</span>
        Description</h3>

        <div class="outline-text-3" id="text-1-1">
          <p>Orgmk is a suite of Bash scripts for <b>automating the conversion
          of Org mode documents to different formats</b> (such as HTML or PDF)
          from the command line.</p>

          <p>The scripts run on both Unix and Microsoft Windows (with
          Cygwin).</p>
        </div>
      </div>

      <div id="outline-container-sec-1-2" class="outline-3">
        <h3 id="sec-1-2"><span class="section-number-3">1.2</span>
        Objectives</h3>

        <div class="outline-text-3" id="text-1-2">
          <p>The first goal is to <b>be more productive</b>, by running the
          export only when the source Org files are updated.</p>

          <p>The second goal is to <b>share some common Emacs and Org
          configuration inside your</b> <b>team</b>, separately of what you
          have in your personal Emacs configuration file.</p>

          <p>Finally, the third goal is also to <b>offload compilation into an
          external batch Emacs process</b>, allowing you to go on editing or
          working while exporting the documents.</p>
        </div>
      </div>

      <div id="outline-container-sec-1-3" class="outline-3">
        <h3 id="sec-1-3"><span class="section-number-3">1.3</span>
        Requirements</h3>

        <div class="outline-text-3" id="text-1-3"></div>

        <div id="outline-container-sec-1-3-1" class="outline-4">
          <h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Emacs
          24</h4>

          <div class="outline-text-4" id="text-1-3-1">
            <p>Emacs version 24 (for the “package” facility) must be in your
            <code>PATH</code>.</p>
          </div>
        </div>

        <div id="outline-container-sec-1-3-2" class="outline-4">
          <h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Org
          8</h4>

          <div class="outline-text-4" id="text-1-3-2">
            <p>Org mode version 8 (or later) is required.</p>

            <p>If such a version is not bundled with your Emacs, Org 8 will be
            automatically installed – if you accept it! – through ELPA.</p>
          </div>
        </div>

        <div id="outline-container-sec-1-3-3" class="outline-4">
          <h4 id="sec-1-3-3"><span class="section-number-4">1.3.3</span> LaTeX
          (PDF)</h4>

          <div class="outline-text-4" id="text-1-3-3">
            <p>A working LaTeX installation is required for exporting to PDF.
            If it is not yet installed on your system, install <a href=
            "http://www.tug.org/texlive/">TeX Live</a> (for example).</p>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-2" class="outline-2">
      <h2 id="sec-2"><span class="section-number-2">2</span> Usage</h2>

      <div class="outline-text-2" id="text-2">
        <p>Org files can have the extension ~.org~ or ~.txt~.</p>
      </div>

      <div id="outline-container-sec-2-1" class="outline-3">
        <h3 id="sec-2-1"><span class="section-number-3">2.1</span> Standalone
        scripts</h3>

        <div class="outline-text-3" id="text-2-1">
          <div class="org-src-container">
            <pre class="src src-sh">
org2html [OPTION] FILE
org2latex [OPTION] FILE
org2pdf [OPTION] FILE
org2beamerpdf [OPTION] FILE
org2odt [OPTION] FILE
org2txt [OPTION] FILE
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-2-2" class="outline-3">
        <h3 id="sec-2-2"><span class="section-number-3">2.2</span> Makefile
        wrapper</h3>

        <div class="outline-text-3" id="text-2-2">
          <div class="org-src-container">
            <pre class="src src-sh">
orgmk [OPTION]
orgmk [OPTION] [html | pdf]
orgmk [OPTION] [FILE]
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-3" class="outline-2">
      <h2 id="sec-3"><span class="section-number-2">3</span> Options</h2>

      <div class="outline-text-2" id="text-3"></div>

      <div id="outline-container-sec-3-1" class="outline-3">
        <h3 id="sec-3-1"><span class="section-number-3">3.1</span> Standalone
        scripts</h3>

        <div class="outline-text-3" id="text-3-1">
          <dl class="org-dl">
            <dt>=-h=, =–help=</dt>

            <dd>Print usage information and exit.</dd>

            <dt>=-y=</dt>

            <dd>
              Authorize the update of the source file (update of dynamic blocks
              and re-computation of tables) without confirmation.

              <p>Before the conversion, the standalone scripts will try to
              <b>update all dynamic blocks and recompute all tables</b> in the
              source Org file, a <b>potentially destructive operation</b> for
              which the programs require confirmation: in case the source file
              gets updated, you will be queried to overwrite the source file
              with the update version of the file – that’s because the
              environment variable <code>UPDATE_SRC</code> defaults to
              <code>query</code>.</p>

              <p>To avoid the question, you can also set that variable to
              <code>yes</code> or <code>no</code> in a personal configuration
              file, <code>~/.orgmk-rc</code>.</p>

              <p>Note that, by design, the command line argument =-y= is passed
              to every <code>org2&lt;BACKEND&gt;</code> script called from
              <code>orgmk</code>, so that <code>orgmk</code> doesn’t wait for
              answers.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-3-2" class="outline-3">
        <h3 id="sec-3-2"><span class="section-number-3">3.2</span> Makefile
        wrapper</h3>

        <div class="outline-text-3" id="text-3-2">
          <dl class="org-dl">
            <dt>=-h=, =–help=</dt>

            <dd>Print usage information and exit.</dd>

            <dt>=-r=, =–recursive=</dt>

            <dd>
              Export all Org files <b>under each directory, recursively</b>.

              <p>It just calls <code>orgmk.mk</code> with the argument
              <code>ALLSUBDIRS=yes</code>.</p>

              <p>By default, <code>orgmk</code> exports all Org files (which
              need it) in the current directory only.</p>
            </dd>
          </dl>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-4" class="outline-2">
      <h2 id="sec-4"><span class="section-number-2">4</span> Files</h2>

      <div class="outline-text-2" id="text-4">
        <p><i>$HOME/.orgmk-rc</i></p>
      </div>
    </div>

    <div id="outline-container-sec-5" class="outline-2">
      <h2 id="sec-5"><span class="section-number-2">5</span> Examples</h2>

      <div class="outline-text-2" id="text-5"></div>

      <div id="outline-container-sec-5-1" class="outline-3">
        <h3 id="sec-5-1"><span class="section-number-3">5.1</span> Update all
        documents</h3>

        <div class="outline-text-3" id="text-5-1">
          <p>Regenerate HTML and/or PDF files for Org files that have been
          modified.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
orgmk
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-5-2" class="outline-3">
        <h3 id="sec-5-2"><span class="section-number-3">5.2</span> Update
        specific types of documents</h3>

        <div class="outline-text-3" id="text-5-2">
          <p>Regenerate HTML only for the Org files that have been changed.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
orgmk html
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-5-3" class="outline-3">
        <h3 id="sec-5-3"><span class="section-number-3">5.3</span> Update
        specific document</h3>

        <div class="outline-text-3" id="text-5-3">
          <p>Regenerate (or create for the first time) the file
          <code>thesis.pdf</code> from the Org file <code>thesis.org</code> or
          <code>thesis.txt</code>. <b>Don’t require confirmation for updating
          the source file.</b></p>

          <div class="org-src-container">
            <pre class="src src-sh">
orgmk thesis.pdf
</pre>
          </div>

          <p>Regenerate (or create for the first time) the file
          <code>thesis.pdf</code> from the Org file <code>thesis.org</code>.
          Require confirmation for updating the source file.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
org2pdf thesis.org
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-6" class="outline-2">
      <h2 id="sec-6"><span class="section-number-2">6</span> Installation</h2>

      <div class="outline-text-2" id="text-6">
        <p>The installation process consists of creating symbolic links from
        the standard <b>final directories</b> on your machine to the
        <code>orgmk</code> executables.</p>
      </div>

      <div id="outline-container-sec-6-1" class="outline-3">
        <h3 id="sec-6-1"><span class="section-number-3">6.1</span> New
        install</h3>

        <div class="outline-text-3" id="text-6-1">
          <ol class="org-ol">
            <li>
              <b>Extract</b> the latest version of <code>orgmk</code>.

              <div class="org-src-container">
                <pre class="src src-sh">
git clone git@github.com:fniessen/orgmk.git
</pre>
              </div>
            </li>

            <li>Create configuration files which record where
            <code>orgmk</code> has been extracted on your host machine.

              <div class="org-src-container">
                <pre class="src src-sh">
make
</pre>
              </div>
            </li>

            <li>By default, the <code>orgmk</code> executable and the
            standalone scripts (<code>org2html</code>, <code>org2pdf</code>,
            etc.) are installed to the <code>/usr/local/bin</code> so that all
            users are able to run them.

              <p>If you want to <b>change the destination directory</b>, create
              a <code>Make.params</code> file with the target directory. For
              example:</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">BIN_DIR</span>=~/bin
</pre>
              </div>

              <p>If needed, add that directory to your <code>PATH</code>.</p>

              <p><b>Install</b> <code>orgmk</code> (executable and standalone
              scripts that you run) to the <code>BIN_DIR</code> location by
              typing:</p>

              <div class="org-src-container">
                <pre class="src src-sh">
make install
</pre>
              </div>
            </li>
          </ol>

          <p>At this point, everything should be ready for use.</p>
        </div>
      </div>

      <div id="outline-container-sec-6-2" class="outline-3">
        <h3 id="sec-6-2"><span class="section-number-3">6.2</span> Makefile for
        installation</h3>

        <div class="outline-text-3" id="text-6-2">
          <div class="org-src-container">
            <pre class="src src-makefile">
<span style="color: #8D8D84;">### </span><span style=
"color: #8D8D84; font-style: italic;">-*- Makefile -*- definition file for Orgmk</span>

<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">To install `orgmk', type `make' and then `make install'.</span>

<span style="color: #BA36A5;">PWD</span>=$(<span style=
"color: #BA36A5;">shell</span> pwd)

<span style="color: #BA36A5;">BIN_DIR</span>=/usr/local/bin

-include Make.params

<span style="color: #BA36A5;">ORGMK_ROOT</span>=$(<span style=
"color: #BA36A5;">PWD</span>)
<span style="color: #BA36A5;">ORGMK_EL</span>=$(<span style=
"color: #BA36A5;">ORGMK_ROOT</span>)/site-lisp/orgmk.el

<span style="color: #8D8D84;"># </span><span style=
"color: #CC0000; background-color: #FFFF88; font-style: italic;">WARNING</span><span style="color: #8D8D84; font-style: italic;">: ORGMK_EL must contain the correct path to the</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">`orgmk.el' file according to the Emacs version used (Windows,</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">Cygwin or Linux path)</span>
<span style="color: #BA36A5;">EMACS_SYSTEM_TYPE</span>=$(<span style=
"color: #BA36A5;">shell</span> emacs -batch --eval <span style=
"color: #036A07;">"(message \"%s\" system-type)"</span> 2&gt;&amp;1)
ifeq ($(<span style="color: #BA36A5;">EMACS_SYSTEM_TYPE</span>),windows-nt)
    <span style="color: #BA36A5;">ORGMK_EL</span>:=<span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">shell</span><span style=
"color: #036A07;"> cygpath --mixed $(</span><span style=
"color: #BA36A5;">ORGMK_EL</span><span style="color: #036A07;">))"</span>
endif

<span style="color: #BA36A5;">ORGMK_INIT</span>=orgmk-init
<span style="color: #BA36A5;">ORGMK_SYSTEM_CONFIG</span>=orgmk.conf
<span style="color: #BA36A5;">ORGMK_UPDATE</span>=orgmk-update-src
<span style=
"color: #BA36A5;">ORGMK_UPDATE_CHECK_DIFF</span>=orgmk-update-src-check-diff
<span style="color: #BA36A5;">ORG2HTML</span>=org2html
<span style="color: #BA36A5;">ORG2LATEX</span>=org2latex
<span style="color: #BA36A5;">ORG2PDF</span>=org2pdf
<span style="color: #BA36A5;">ORG2BEAMERPDF</span>=org2beamerpdf
<span style="color: #BA36A5;">ORG2ODT</span>=org2odt
<span style="color: #BA36A5;">ORG2TXT</span>=org2txt
<span style="color: #BA36A5;">ORGMK_MAKE_SETUP</span>=orgmk-stow-orgmk.mk
<span style="color: #BA36A5;">ORGMK_MAKE_RUN</span>=orgmk

<span style="color: #8D8D84;">## </span><span style=
"color: #8D8D84; font-style: italic;">MAKE</span>

<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">Ensure `all' is the default target</span>
<span style=
"color: #0000ff; font-weight: bold;">all</span>: orgmk-system-config orgmk-stow-mk  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Create Orgmk system files</span>

<span style=
"color: #0000ff; font-weight: bold;">.PHONY</span>: orgmk-system-config
<span style=
"color: #0000ff; font-weight: bold;">orgmk-system-config</span>:                    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Create file with location of `orgmk.el'</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span><span style=
"color: #6434A3;">@</span>echo <span style=
"color: #036A07;">"Generating system-wide configuration file..."</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>echo <span style=
"color: #036A07;">"ORGMK_EL=$(</span><span style=
"color: #BA36A5;">ORGMK_EL</span><span style=
"color: #036A07;">)"</span> &gt; bin/$(<span style=
"color: #BA36A5;">ORGMK_SYSTEM_CONFIG</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span><span style=
"color: #6434A3;">@</span>echo

<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: orgmk-stow-mk
<span style=
"color: #0000ff; font-weight: bold;">orgmk-stow-mk</span>:                          <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Create core file for `orgmk'</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span><span style=
"color: #6434A3;">@</span>echo <span style=
"color: #036A07;">"Generating setup file..."</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>echo <span style=
"color: #036A07;">"#!/bin/sh"</span> &gt; bin/$(<span style=
"color: #BA36A5;">ORGMK_MAKE_SETUP</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>echo <span style=
"color: #036A07;">"ln -f -s $(</span><span style=
"color: #BA36A5;">PWD</span><span style=
"color: #036A07;">)/bin/orgmk.mk orgmk.mk"</span> &gt;&gt; bin/$(<span style=
"color: #BA36A5;">ORGMK_MAKE_SETUP</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>chmod +x bin/$(<span style="color: #BA36A5;">ORGMK_MAKE_SETUP</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span><span style=
"color: #6434A3;">@</span>echo

<span style="color: #8D8D84;">## </span><span style=
"color: #8D8D84; font-style: italic;">MAKE INSTALL</span>

<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: install
<span style=
"color: #0000ff; font-weight: bold;">install</span>:                                <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Create symlinks to Orgmk scripts</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span><span style=
"color: #6434A3;">@</span>echo <span style=
"color: #036A07;">"Creating symlinks..."</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORGMK_INIT</span>)              $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORGMK_INIT</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORGMK_SYSTEM_CONFIG</span>)     $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORGMK_SYSTEM_CONFIG</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORGMK_UPDATE</span>)            $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORGMK_UPDATE</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORGMK_UPDATE_CHECK_DIFF</span>) $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORGMK_UPDATE_CHECK_DIFF</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORG2HTML</span>)                $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORG2HTML</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORG2LATEX</span>)               $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORG2LATEX</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORG2PDF</span>)                 $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORG2PDF</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORG2BEAMERPDF</span>)           $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORG2BEAMERPDF</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORG2ODT</span>)                 $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORG2ODT</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORG2TXT</span>)                 $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORG2TXT</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORGMK_MAKE_SETUP</span>)        $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORGMK_MAKE_SETUP</span>)
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>ln -f -s $(<span style="color: #BA36A5;">PWD</span>)/bin/$(<span style="color: #BA36A5;">ORGMK_MAKE_RUN</span>)          $(<span style="color: #BA36A5;">BIN_DIR</span>)/$(<span style="color: #BA36A5;">ORGMK_MAKE_RUN</span>)

<span style="color: #8D8D84;">### </span><span style=
"color: #8D8D84; font-style: italic;">Makefile ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-7" class="outline-2">
      <h2 id="sec-7"><span class="section-number-2">7</span> Standalone
      scripts</h2>

      <div class="outline-text-2" id="text-7"></div>

      <div id="outline-container-sec-7-1" class="outline-3">
        <h3 id="sec-7-1"><span class="section-number-3">7.1</span>
        Orgmk-init</h3>

        <div class="outline-text-3" id="text-7-1">
          <p>The <code>orgmk-init</code> script contains the common part used
          to setup Emacs and Org in order to export to HTML, PDF, etc.</p>
        </div>

        <div id="outline-container-sec-7-1-1" class="outline-4">
          <h4 id="sec-7-1-1"><span class="section-number-4">7.1.1</span>
          Functions</h4>

          <div class="outline-text-4" id="text-7-1-1">
            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #006699;">Usage</span> ()
{
    cat &lt;&lt; EOF 1&gt;&amp;2
<span style=
"color: #0000ff; background-color: #EEF5FE;">Usage: $(basename $0) [OPTION] FILE</span>
<span style=
"color: #0000ff; background-color: #EEF5FE;">Convert FILE to another format.</span>

<span style=
"color: #0000ff; background-color: #EEF5FE;">  -h, --help     display this help and exit</span>
<span style=
"color: #0000ff; background-color: #EEF5FE;">  -y             authorize update of the source file without confirmation</span>

<span style=
"color: #0000ff; background-color: #EEF5FE;">Report $(basename $0) bugs to fni@missioncriticalit.com</span>
<span style="color: #0000ff; background-color: #EEF5FE;">EOF</span>
    <span style="color: #0000FF;">exit</span> 1
}
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #006699;">die</span> () {
    printf <span style=
"color: #036A07;">"$(basename $0): $@\n"</span> &gt; /dev/stderr
    <span style="color: #0000FF;">exit</span> 2 <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">an </span><span style=
"color: #CC0000; background-color: #FFFF88; font-style: italic;">error</span><span style="color: #8D8D84; font-style: italic;"> occurred</span>
}
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #006699;">CleanUp</span> ()
{
    <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">restore backed up target file if it hasn't been produced</span>
    <span style="color: #0000FF;">if</span> [ ! -z $<span style=
"color: #BA36A5;">FILE_TARGET</span> ]; <span style=
"color: #0000FF;">then</span>
        <span style="color: #0000FF;">if</span> [ -r $<span style=
"color: #BA36A5;">FILE_TARGET</span>.bak ]; <span style=
"color: #0000FF;">then</span>
            <span style="color: #0000FF;">if</span> [ ! -r $<span style=
"color: #BA36A5;">FILE_TARGET</span> ]; <span style=
"color: #0000FF;">then</span>
                printf <span style=
"color: #036A07;">"Recovering OLD file $FILE_TARGET...\n"</span>
                mv $<span style=
"color: #BA36A5;">FILE_TARGET</span>.bak $<span style=
"color: #BA36A5;">FILE_TARGET</span>
            <span style="color: #0000FF;">else</span>
                rm $<span style="color: #BA36A5;">FILE_TARGET</span>.bak
            <span style="color: #0000FF;">fi</span>
        <span style="color: #0000FF;">fi</span>
    <span style="color: #0000FF;">fi</span>

    <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">display log file, if present</span>
    <span style="color: #0000FF;">if</span> [ ! -z $<span style=
"color: #BA36A5;">FILE_LOG</span> ]; <span style="color: #0000FF;">then</span>
        <span style="color: #0000FF;">if</span> [ -r $<span style=
"color: #BA36A5;">FILE_LOG</span> ]; <span style="color: #0000FF;">then</span>
            grep -e <span style=
"color: #036A07;">"^!.*"</span> -A 3 -B 1 $<span style=
"color: #BA36A5;">FILE_LOG</span>
        <span style="color: #0000FF;">fi</span>
    <span style="color: #0000FF;">fi</span>

    <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">remove the temporary copy of the source Org file</span>
    <span style="color: #0000FF;">if</span> [ ! -z $<span style=
"color: #BA36A5;">FILE_SRC_UPDT</span> ]; <span style=
"color: #0000FF;">then</span>
        rm -f $<span style="color: #BA36A5;">FILE_SRC_UPDT</span>
    <span style="color: #0000FF;">fi</span>
}
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-7-1-2" class="outline-4">
          <h4 id="sec-7-1-2"><span class="section-number-4">7.1.2</span>
          Runtime</h4>

          <div class="outline-text-4" id="text-7-1-2">
            <div class="org-src-container">
              <pre class="src src-sh" id="current-time">
<span style="color: #006FE0;">echo</span> <span style=
"color: #036A07;">"$(date '+%Y%m%d.%H%M')"</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
    cat &lt;&lt; EOF
<span style=
"color: #0000ff; background-color: #EEF5FE;">This is $(basename $0), version: 20140328.1411.</span>
<span style="color: #0000ff; background-color: #EEF5FE;">EOF</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">perform housekeeping on program exit or a variety of signals</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">(EXIT, HUP, INT, QUIT, TERM)</span>
<span style="color: #0000FF;">trap</span> CleanUp 0 1 2 3 15
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">load the system-wide config file (definition of `ORGMK_EL')</span>
. orgmk.conf

<span style="color: #0000FF;">if</span> [ <span style=
"color: #036A07;">"$ORGMK_EL"</span> = <span style=
"color: #036A07;">""</span> ]; <span style="color: #0000FF;">then</span>
    printf <span style=
"color: #036A07;">"ORGMK_EL variable not defined, please check your setup!\n"</span>
    <span style="color: #0000FF;">exit</span> 2
<span style="color: #0000FF;">fi</span>

<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">source the user config file (default for `UPDATE_SRC', etc.)</span>
<span style="color: #BA36A5;">ORGMK_USER_CONF</span>=$<span style=
"color: #BA36A5;">HOME</span>/.orgmk-rc
<span style="color: #0000FF;">if</span> [ -r $<span style=
"color: #BA36A5;">ORGMK_USER_CONF</span> ]; <span style=
"color: #0000FF;">then</span>
    . $<span style="color: #BA36A5;">ORGMK_USER_CONF</span>
<span style="color: #0000FF;">fi</span>

<span style="color: #006FE0;">export</span> UPDATE_SRC

<span style="color: #0000FF;">while </span><span style=
"color: #006FE0;">true</span>; <span style="color: #0000FF;">do</span>
    <span style="color: #0000FF;">case</span> <span style=
"color: #036A07;">"$1"</span><span style="color: #0000FF;"> in</span>
        -y ) <span style="color: #BA36A5;">UPDATE_SRC</span>=<span style=
"color: #036A07;">"yes"</span>; <span style="color: #006FE0;">shift</span> ;;
        -h | --help ) Usage ;;
        * ) <span style="color: #0000FF;">break</span> ;;
    <span style="color: #0000FF;">esac</span>
<span style="color: #0000FF;">done</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">now do something with $@</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #0000FF;">if</span> [ $<span style=
"color: #BA36A5;">#</span> -ne 1 ]; <span style="color: #0000FF;">then</span>
    Usage
<span style="color: #0000FF;">fi</span>

<span style="color: #BA36A5;">FILE_SRC_ORIG</span>=$<span style=
"color: #BA36A5;">1</span>
<span style="color: #0000FF;">if</span> [ ! -r <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> ]; <span style=
"color: #0000FF;">then</span>
    die <span style="color: #036A07;">"Cannot read file $FILE_SRC_ORIG"</span>
<span style="color: #0000FF;">fi</span>

<span style="color: #BA36A5;">FILE_SRC_UPDT</span>=<span style=
"color: #036A07;">"${FILE_SRC_ORIG%.*}.orgmk"</span> <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">replace extension</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">The temporary file only differ by its extension (`.orgmk'), so that the</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">exported file will be named &lt;orig file name&gt;.&lt;backend ext&gt;.</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #BA36A5;">FILE_LOG</span>=<span style=
"color: #036A07;">"${FILE_SRC_ORIG%.*}.log"</span>
rm -f $<span style="color: #BA36A5;">FILE_LOG</span>
</pre>
            </div>

            <p>If the PDF file isn’t produced (for example, because of an
            <i>undefined control sequence</i>), there is no PDF file anymore;
            hence, <code>orgmk</code> would ignore the source file in future
            calls, and the PDF file (now, missing…) would completely disappear
            from the user attention.</p>

            <p>To avoid that, we must make a backup of the target file before
            the export, and put it back if there is no target file
            produced.</p>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #BA36A5;">FILE_TARGET</span>=<span style=
"color: #036A07;">"${FILE_SRC_ORIG%.*}.$TARGET_EXT"</span>

<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">back up previous version of target file</span>
<span style="color: #0000FF;">if</span> [ -r $<span style=
"color: #BA36A5;">FILE_TARGET</span> ]; <span style=
"color: #0000FF;">then</span>
    mv $<span style="color: #BA36A5;">FILE_TARGET</span> $<span style=
"color: #BA36A5;">FILE_TARGET</span>.bak
<span style="color: #0000FF;">fi</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #BA36A5;">EMACS</span>=emacs

<span style="color: #BA36A5;">WHICH_EMACS</span>=$(<span style=
"color: #006FE0;">which</span> $<span style="color: #BA36A5;">EMACS</span>)
<span style="color: #BA36A5;">EMACS_FLAGS</span>=<span style=
"color: #036A07;">"--eval \"(progn (message \\\"Launching $WHICH_EMACS...\\\") (message \\\"Emacs %s (%s)\\\" emacs-version system-type))\""</span>
<span style="color: #BA36A5;">EMACS_BATCH</span>=<span style=
"color: #036A07;">"emacs --batch -Q $EMACS_FLAGS"</span>
<span style="color: #BA36A5;">ORG_FLAGS</span>=<span style=
"color: #036A07;">""</span>
<span style="color: #BA36A5;">ORGMK</span>=<span style=
"color: #036A07;">"$EMACS_BATCH $ORG_FLAGS --eval \"(message \\\"Loading ${ORGMK_EL}...\\\")\" -l $ORGMK_EL"</span>
<span style="color: #BA36A5;">ORGMK_UPDATE_FLAGS</span>=<span style=
"color: #036A07;">"-f org-update-all-dblocks -f org-table-iterate-buffer-tables --eval \"(write-file \\\"${FILE_SRC_UPDT##*/}\\\")\""</span> <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">base name</span>
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-2" class="outline-3">
        <h3 id="sec-7-2"><span class="section-number-3">7.2</span>
        org2html</h3>

        <div class="outline-text-3" id="text-7-2">
          <p>The <code>org2html</code> script converts an Org file to HTML.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #BA36A5;">TARGET_EXT</span>=html
. orgmk-init

<span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-html-export-to-html <span style="color: #036A07;">\</span>
    || die <span style="color: #036A07;">"Exported file wasn't produced"</span>
orgmk-update-src-check-diff <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-3" class="outline-3">
        <h3 id="sec-7-3"><span class="section-number-3">7.3</span>
        org2latex</h3>

        <div class="outline-text-3" id="text-7-3">
          <p>The <code>org2latex</code> script converts an Org file to
          LaTeX.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #BA36A5;">TARGET_EXT</span>=tex
. orgmk-init

<span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-latex-export-to-latex <span style="color: #036A07;">\</span>
    || die <span style="color: #036A07;">"Exported file wasn't produced"</span>
orgmk-update-src-check-diff <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-4" class="outline-3">
        <h3 id="sec-7-4"><span class="section-number-3">7.4</span> org2pdf</h3>

        <div class="outline-text-3" id="text-7-4">
          <p>The <code>org2pdf</code> script converts an Org file to PDF.</p>

          <p>It tries to detect whether the target is a standard LaTeX document
          or a Beamer presentation by searching for the string
          <code>#+BEAMER_THEME:</code> inside the Org source.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #BA36A5;">TARGET_EXT</span>=pdf
. orgmk-init

<span style="color: #0000FF;">if</span> grep -E <span style=
"color: #036A07;">"^#\+BEAMER_THEME: "</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> &gt; /dev/null; <span style=
"color: #0000FF;">then</span>
    <span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-beamer-export-to-latex <span style="color: #036A07;">\</span>
        || die <span style=
"color: #036A07;">"Exported file wasn't produced"</span>
<span style="color: #0000FF;">else</span>
    <span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-latex-export-to-latex <span style="color: #036A07;">\</span>
        || die <span style=
"color: #036A07;">"Exported file wasn't produced"</span>
<span style="color: #0000FF;">fi</span>
orgmk-update-src-check-diff <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-5" class="outline-3">
        <h3 id="sec-7-5"><span class="section-number-3">7.5</span>
        org2beamerpdf</h3>

        <div class="outline-text-3" id="text-7-5">
          <p>The <code>org2beamerpdf</code> script converts an Org file to a
          Beamer presentation (PDF).</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #BA36A5;">TARGET_EXT</span>=pdf
. orgmk-init

<span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-beamer-export-to-pdf <span style="color: #036A07;">\</span>
    || die <span style="color: #036A07;">"Exported file wasn't produced"</span>
orgmk-update-src-check-diff <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-6" class="outline-3">
        <h3 id="sec-7-6"><span class="section-number-3">7.6</span> org2odt</h3>

        <div class="outline-text-3" id="text-7-6">
          <p>The <code>org2odt</code> script converts an Org file to ODT.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #BA36A5;">TARGET_EXT</span>=odt
. orgmk-init

<span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-odt-export-to-odt <span style="color: #036A07;">\</span>
    || die <span style="color: #036A07;">"Exported file wasn't produced"</span>
orgmk-update-src-check-diff <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-7" class="outline-3">
        <h3 id="sec-7-7"><span class="section-number-3">7.7</span> org2txt</h3>

        <div class="outline-text-3" id="text-7-7">
          <p>The <code>org2txt</code> script converts an Org file to text.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #BA36A5;">TARGET_EXT</span>=txt
. orgmk-init

<span style="color: #006FE0;">eval</span> $<span style=
"color: #BA36A5;">ORGMK</span> $<span style=
"color: #BA36A5;">FILE_SRC_ORIG</span> $<span style=
"color: #BA36A5;">ORGMK_UPDATE_FLAGS</span> -f org-ascii-export-to-ascii <span style="color: #036A07;">\</span>
    || die <span style="color: #036A07;">"Exported file wasn't produced"</span>
orgmk-update-src-check-diff <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-8" class="outline-3">
        <h3 id="sec-7-8"><span class="section-number-3">7.8</span>
        Orgmk-update-src-check-diff</h3>

        <div class="outline-text-3" id="text-7-8">
          <p>Check whether dynamic blocks and tables have been updated, and (if
          yes) propose to overwrite the source Org file.</p>
        </div>

        <div id="outline-container-sec-7-8-1" class="outline-4">
          <h4 id="sec-7-8-1"><span class="section-number-4">7.8.1</span>
          Functions</h4>

          <div class="outline-text-4" id="text-7-8-1">
            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #006699;">ask</span> () {
    <span style="color: #0000FF;">while </span><span style=
"color: #006FE0;">true</span>; <span style="color: #0000FF;">do</span>
        <span style="color: #0000FF;">if</span> [ <span style=
"color: #036A07;">"${2:-}"</span> = <span style=
"color: #036A07;">"Y"</span> ]; <span style="color: #0000FF;">then</span>
            <span style="color: #BA36A5;">prompt</span>=<span style=
"color: #036A07;">"Y/n"</span>
            <span style="color: #BA36A5;">default</span>=Y
        <span style="color: #0000FF;">elif</span> [ <span style=
"color: #036A07;">"${2:-}"</span> = <span style=
"color: #036A07;">"N"</span> ]; <span style="color: #0000FF;">then</span>
            <span style="color: #BA36A5;">prompt</span>=<span style=
"color: #036A07;">"y/N"</span>
            <span style="color: #BA36A5;">default</span>=N
        <span style="color: #0000FF;">else</span>
            <span style="color: #BA36A5;">prompt</span>=<span style=
"color: #036A07;">"y/n"</span>
            <span style="color: #BA36A5;">default</span>=
        <span style="color: #0000FF;">fi</span>

        <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">ask the question (without the need to press RET)</span>
        printf <span style="color: #036A07;">"$1 ($prompt): "</span>
        <span style="color: #006FE0;">read</span> -n 1 -r REPLY
        printf <span style="color: #036A07;">"\n"</span> <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">just a final linefeed</span>

        <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">default?</span>
        <span style="color: #0000FF;">if</span> [ -z <span style=
"color: #036A07;">"$REPLY"</span> ]; <span style="color: #0000FF;">then</span>
            <span style="color: #BA36A5;">REPLY</span>=$<span style=
"color: #BA36A5;">default</span>
        <span style="color: #0000FF;">fi</span>

        <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">check if the reply is valid</span>
        <span style="color: #0000FF;">case</span> <span style=
"color: #036A07;">"$REPLY"</span><span style="color: #0000FF;"> in</span>
            y*|Y*) <span style="color: #0000FF;">return</span> 0 ;;
            n*|N*) <span style="color: #0000FF;">return</span> 1 ;;
        <span style="color: #0000FF;">esac</span>
    <span style="color: #0000FF;">done</span>
}
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-7-8-2" class="outline-4">
          <h4 id="sec-7-8-2"><span class="section-number-4">7.8.2</span>
          Runtime</h4>

          <div class="outline-text-4" id="text-7-8-2">
            <div class="org-src-container">
              <pre class="src src-sh">
<span style="color: #BA36A5;">FILE_SRC_ORIG</span>=$<span style=
"color: #BA36A5;">1</span>
<span style="color: #BA36A5;">FILE_SRC_UPDT</span>=$<span style=
"color: #BA36A5;">2</span>

<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">set a default value</span>
: ${<span style="color: #BA36A5;">UPDATE_SRC</span>:=<span style=
"color: #036A07;">"query"</span>}

<span style="color: #0000FF;">if</span> [ ! -r <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span> ]; <span style=
"color: #0000FF;">then</span>
    printf <span style=
"color: #036A07;">"Cannot read file $FILE_SRC_UPDT\n"</span>
<span style="color: #0000FF;">else</span>
    <span style="color: #0000FF;">if</span> diff -q <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span> <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span> &gt; /dev/null; <span style=
"color: #0000FF;">then</span>
        rm <span style="color: #036A07;">"$FILE_SRC_UPDT"</span>
    <span style="color: #0000FF;">else</span>
        <span style="color: #0000FF;">if</span> [[ <span style=
"color: #036A07;">"$UPDATE_SRC"</span> = <span style=
"color: #036A07;">"query"</span> ]]; <span style="color: #0000FF;">then</span>
            ask <span style=
"color: #036A07;">"Update source file?"</span> &amp;&amp; <span style=
"color: #BA36A5;">UPDATE_SRC</span>=<span style=
"color: #036A07;">"yes"</span> || <span style=
"color: #BA36A5;">UPDATE_SRC</span>=<span style="color: #036A07;">"no"</span>
        <span style="color: #0000FF;">fi</span>

        <span style="color: #0000FF;">if</span> [[ <span style=
"color: #036A07;">"$UPDATE_SRC"</span> = <span style=
"color: #036A07;">"yes"</span> ]]; <span style="color: #0000FF;">then</span>
            mv <span style=
"color: #036A07;">"$FILE_SRC_UPDT"</span> <span style=
"color: #036A07;">"$FILE_SRC_ORIG"</span>
            printf <span style=
"color: #036A07;">"${C_INFO}Dynamic blocks and tables in \`$FILE_SRC_ORIG' successfully updated${C_RESET}\n"</span>
        <span style="color: #0000FF;">else</span>
            printf <span style=
"color: #036A07;">"Nothing gets updated...\n"</span>
        <span style="color: #0000FF;">fi</span>
    <span style="color: #0000FF;">fi</span>
<span style="color: #0000FF;">fi</span>
</pre>
            </div>

            <p>In order to avoid “file changed on disk” messages (and be forced
            to revert open buffers) when nothing changed, we save the file with
            another name, and diff it with the original file. If there is no
            change, the new file is dropped.</p>

            <div class="note">
              <p>The time stamps in “Clock summary at …” will be different,
              each time dynamic blocks are updated (if not done during the same
              minute). In that case, <code>diff</code> will always
              “succeed”.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-8" class="outline-2">
      <h2 id="sec-8"><span class="section-number-2">8</span> Orgmk</h2>

      <div class="outline-text-2" id="text-8"></div>

      <div id="outline-container-sec-8-1" class="outline-3">
        <h3 id="sec-8-1"><span class="section-number-3">8.1</span>
        Orgmk.mk</h3>

        <div class="outline-text-3" id="text-8-1">
          <p>Here is the “ultimate” Makefile to <b>automate the generation of
          HTML or PDF</b> versions from your Org mode files.</p>

          <p>It is designed to solve tedious tasks nicely, such as
          updating:</p>

          <ul class="org-ul">
            <li>☑ table of contents,</li>

            <li>☑ cross-references,</li>

            <li>☐ index,</li>

            <li>☐ list of figures,</li>

            <li>☐ BibTeX references,</li>

            <li>☑ Org dynamic blocks,</li>

            <li>☑ tables with formulas, and</li>

            <li>☐ extracting (tangle) code blocks.

              <table class="inlinetask" width="100%">
                <tr>
                  <td valign="top"><b><span class=
                  "todo TODO">TODO</span></b></td>

                  <td width="100%">
                    <b>Test whether Orgmk works with symbolic links</b><br />

                    <p>Does their modification time change to reflect the
                    latest modification of the source?</p>
                  </td>
                </tr>
              </table>
            </li>
          </ul>
        </div>

        <div id="outline-container-sec-8-1-1" class="outline-4">
          <h4 id="sec-8-1-1"><span class="section-number-4">8.1.1</span> Some
          system-dependent stuff</h4>

          <div class="outline-text-4" id="text-8-1-1">
            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #8D8D84;">### </span><span style=
"color: #8D8D84; font-style: italic;">-*- Makefile -*- definition file for Orgmk</span>
</pre>
            </div>
          </div>

          <div id="outline-container-sec-8-1-1-1" class="outline-5">
            <h5 id="sec-8-1-1-1">Default shell</h5>

            <div class="outline-text-5" id="text-8-1-1-1">
              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">SHELL</span> = /bin/sh
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-8-1-1-2" class="outline-5">
            <h5 id="sec-8-1-1-2">Exportation scripts</h5>

            <div class="outline-text-5" id="text-8-1-1-2">
              <p>By default, the <code>orgmk.mk</code> will overwrite the Org
              source file if it has changed after dblocks update and tables
              re-computation.</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">ORG2_FLAGS</span>=-y

<span style="color: #BA36A5;">ORG2HTML</span>=org2html $(<span style=
"color: #BA36A5;">ORG2_FLAGS</span>)
<span style="color: #BA36A5;">ORG2PDF</span>=org2pdf $(<span style=
"color: #BA36A5;">ORG2_FLAGS</span>)
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-8-1-1-3" class="outline-5">
            <h5 id="sec-8-1-1-3">Viewing stuff</h5>

            <div class="outline-text-5" id="text-8-1-1-3">
              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">VIEW_HTML</span> ?= firefox
<span style="color: #BA36A5;">VIEW_PDF</span> ?= xpdf
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-8-1-1-4" class="outline-5">
            <h5 id="sec-8-1-1-4">Color output</h5>

            <div class="outline-text-5" id="text-8-1-1-4">
              <div class="org-src-container">
                <pre class="src src-makefile">
ifdef NO_COLOR
    <span style="color: #BA36A5;">tput</span> =
else
    <span style="color: #BA36A5;">tput</span> = $(<span style=
"color: #BA36A5;">shell</span> $(<span style=
"color: #BA36A5;">TPUT</span>) $<span style="color: #D0372D;">1</span>)
endif

<span style="color: #BA36A5;">black</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">   </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 0)
<span style="color: #BA36A5;">red</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">     </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 1)
<span style="color: #BA36A5;">green</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">   </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 2)
<span style="color: #BA36A5;">yellow</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">  </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 3)
<span style="color: #BA36A5;">blue</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">    </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 4)
<span style="color: #BA36A5;">magenta</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;"> </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 5)
<span style="color: #BA36A5;">cyan</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">    </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 6)
<span style="color: #BA36A5;">white</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">   </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,setaf 7)
<span style="color: #BA36A5;">bold</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">    </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,bold)
<span style="color: #BA36A5;">uline</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">   </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,smul)
<span style="color: #BA36A5;">reset</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">   </span>:= $(<span style=
"color: #BA36A5;">call</span> tput,sgr0)
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">C_INFO</span>=<span style=
"color: #036A07;">"\\e[32m"</span>
<span style="color: #BA36A5;">C_</span><span style=
"color: #CC0000; background-color: #FFFF88;">WARNING</span>=<span style=
"color: #036A07;">"\\e[35m"</span>
<span style="color: #BA36A5;">C_SUCCESS</span>=<span style=
"color: #036A07;">"\\e[1\;32m"</span>
<span style="color: #BA36A5;">C_FAILURE</span>=<span style=
"color: #036A07;">"\\e[1\;31m"</span>
<span style="color: #BA36A5;">C_RESET</span>=<span style=
"color: #036A07;">"\\e[0m"</span>
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-8-1-2" class="outline-4">
          <h4 id="sec-8-1-2"><span class="section-number-4">8.1.2</span> Basic
          configuration</h4>

          <div class="outline-text-4" id="text-8-1-2"></div>

          <div id="outline-container-sec-8-1-2-1" class="outline-5">
            <h5 id="sec-8-1-2-1">Org Sources</h5>

            <div class="outline-text-5" id="text-8-1-2-1">
              <p>Discover and process all Org files in the current directory
              (or in the current subtree).</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
ifeq ($(<span style="color: #BA36A5;">ALLSUBDIRS</span>),yes)
    <span style="color: #BA36A5;">TXT_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -name \*.txt)
    <span style="color: #BA36A5;">ORG_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -name \*.org)
    <span style="color: #BA36A5;">HTML_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -name \*.html)
    <span style="color: #BA36A5;">PDF_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -name \*.pdf)
else
    <span style="color: #BA36A5;">TXT_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -maxdepth 1 -name \*.txt)
    <span style="color: #BA36A5;">ORG_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -maxdepth 1 -name \*.org)
    <span style="color: #BA36A5;">HTML_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -maxdepth 1 -name \*.html)
    <span style="color: #BA36A5;">PDF_FILES</span>=$(<span style=
"color: #BA36A5;">shell</span> find . -maxdepth 1 -name \*.pdf)
endif

<span style="color: #BA36A5;">FILES_TO_TANGLE</span> := $(<span style=
"color: #BA36A5;">join</span> $(<span style=
"color: #BA36A5;">ORG_FILES</span>), $(<span style=
"color: #BA36A5;">TXT_FILES</span>))
</pre>
              </div>

              <table class="inlinetask" width="100%">
                <tr>
                  <td valign="top"><b><span class=
                  "todo TODO">TODO</span></b></td>

                  <td width="100%">
                    <b>Add Org_DIRS defaulting to .</b><br />

                    <p>Use Org_DIRS with foreach (?) in the following lists</p>
                  </td>
                </tr>
              </table>

              <table class="inlinetask" width="100%">
                <tr>
                  <td valign="top"><b><span class=
                  "todo TODO">TODO</span></b></td>

                  <td width="100%">
                    <b>Fix problem of Orgfile with .org/.txt
                    extension</b><br />

                    <p>If an Org file exists with the 2 file extensions =.txt=
                    and =.org= (same base name), then we get messages such
                    as:</p>

                    <p>Makefile:102: warning: overriding recipe for target
                    `plot.html’ Makefile:89: warning: ignoring old recipe for
                    target `plot.html’</p>
                  </td>
                </tr>
              </table>
            </div>
          </div>

          <div id="outline-container-sec-8-1-2-2" class="outline-5">
            <h5 id="sec-8-1-2-2">HTML Targets</h5>

            <div class="outline-text-5" id="text-8-1-2-2">
              <p>List of HTML files which can be generated:</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">HTML_FILES_FROM_ORG</span> = $(<span style=
"color: #BA36A5;">patsubst</span> %.org,%.html,$(<span style=
"color: #BA36A5;">ORG_FILES</span>))
<span style="color: #BA36A5;">HTML_FILES_FROM_TXT</span> = $(<span style=
"color: #BA36A5;">patsubst</span> %.txt,%.html,$(<span style=
"color: #BA36A5;">TXT_FILES</span>))
</pre>
              </div>

              <p>List of HTML files to be re-generated (if they have an Org
              counterpart):</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">CUR_HTML_FILES</span> := $(<span style=
"color: #BA36A5;">HTML_FILES</span>)
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-8-1-2-3" class="outline-5">
            <h5 id="sec-8-1-2-3">PDF Targets</h5>

            <div class="outline-text-5" id="text-8-1-2-3">
              <p>List of PDF files which can be generated:</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">PDF_FILES_FROM_ORG</span> = $(<span style=
"color: #BA36A5;">patsubst</span> %.org,%.pdf,$(<span style=
"color: #BA36A5;">ORG_FILES</span>))
<span style="color: #BA36A5;">PDF_FILES_FROM_TXT</span> = $(<span style=
"color: #BA36A5;">patsubst</span> %.txt,%.pdf,$(<span style=
"color: #BA36A5;">TXT_FILES</span>))
</pre>
              </div>

              <p>List of PDF files to be re-generated (if they have an Org
              counterpart):</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">CUR_PDF_FILES</span> := $(<span style=
"color: #BA36A5;">PDF_FILES</span>)
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-8-1-2-4" class="outline-5">
            <h5 id="sec-8-1-2-4">Debugging</h5>

            <div class="outline-text-5" id="text-8-1-2-4">
              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">turn command echo'ing back on with VERBOSE=1</span>
ifndef VERBOSE
    <span style="color: #BA36A5;">QUIET</span> := @
endif
</pre>
              </div>

              <p><b>Everything</b> is echo’ed, even <code>$(shell ...)</code>
              invocations:</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">turn on shell debugging with SHELL_DE</span><span style="color: #CC0000; background-color: #FFFF88; font-style: italic;">BUG</span><span style="color: #8D8D84; font-style: italic;">=1</span>
ifdef SHELL_DE<span style=
"color: #CC0000; background-color: #FFFF88;">BUG</span>
    <span style="color: #BA36A5;">SHELL</span> += -x
endif
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-8-1-2-5" class="outline-5">
            <h5 id="sec-8-1-2-5">Commands</h5>

            <div class="outline-text-5" id="text-8-1-2-5">
              <p>Define variables for each command used in targets:</p>

              <div class="org-src-container">
                <pre class="src src-makefile">
<span style="color: #BA36A5;">PRINTF</span>=$(<span style=
"color: #BA36A5;">QUIET</span>)printf
<span style="color: #BA36A5;">EGREP</span>=$(<span style=
"color: #BA36A5;">QUIET</span>)egrep
<span style="color: #BA36A5;">LS</span>=$(<span style=
"color: #BA36A5;">QUIET</span>)ls
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-8-1-3" class="outline-4">
          <h4 id="sec-8-1-3"><span class="section-number-4">8.1.3</span>
          All</h4>

          <div class="outline-text-4" id="text-8-1-3">
            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: all
<span style=
"color: #0000ff; font-weight: bold;">all</span>: html pdf                           <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Regenerate all HTML and PDF files</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-8-1-4" class="outline-4">
          <h4 id="sec-8-1-4"><span class="section-number-4">8.1.4</span>
          Help</h4>

          <div class="outline-text-4" id="text-8-1-4">
            <p>Get help.</p>

            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: help
<span style=
"color: #0000ff; font-weight: bold;">help</span>:                                   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Display callable targets</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"Usage: orgmk [OPTION]... [TARGET]...\n"</span> &gt; /dev/stderr
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style="color: #036A07;">"\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"What target do you want?\n"</span> &gt; /dev/stderr
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">EGREP</span>) <span style=
"color: #036A07;">"^[^</span><span style=
"color: #d3d3d3; background-color: #f5f5dc;">   </span><span style=
"color: #036A07;">#A-Z]+:"</span> [Mm]akefile \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>| sed <span style=
"color: #036A07;">'s/:[^#]*//'</span> | sed <span style=
"color: #036A07;">'s/^/\n/g'</span> | sed <span style=
"color: #036A07;">'s/# /\n\t/g'</span> &gt; /dev/stderr
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-8-1-5" class="outline-4">
          <h4 id="sec-8-1-5"><span class="section-number-4">8.1.5</span>
          HTML</h4>

          <div class="outline-text-4" id="text-8-1-5">
            <p><code>orgmk html</code> will regenerate all HTML files which
            <b>currently exist</b> in the directory, and whose source Org file
            has changed.</p>

            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: html
<span style="color: #0000ff; font-weight: bold;">html</span>: $(<span style=
"color: #BA36A5;">CUR_HTML_FILES</span>)                 <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">Regenerate all HTML documents from Org</span>
</pre>
            </div>

            <p>To create an HTML file for the <b>first time</b>, type
            <code>orgmk file.html</code>. It will ignore other Org files in the
            directory.</p>

            <div class="org-src-container">
              <pre class="src src-makefile">
<span style=
"color: #0000ff; font-weight: bold;">$(HTML_FILES_FROM_ORG)</span>: %.html: %.org   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Export an Org document to HTML</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_INFO</span><span style=
"color: #036A07;">)Exporting \`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/$</span><span style=
"color: #D0372D;">&lt;</span><span style=
"color: #036A07;">' to HTML...$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">ORG2HTML</span>) $<span style="color: #D0372D;">&lt;</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">LS</span>) -l -t $<span style=
"color: #D0372D;">&lt;</span> <span style=
"color: #0000ff; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span> | head -n 1 | grep -E <span style="color: #036A07;">"\.html"</span> &gt; /dev/null \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>|| { printf <span style="color: #036A07;">"$(</span><span style="color: #BA36A5;">C_FAILURE</span><span style="color: #036A07;">)\`$(</span><span style="color: #BA36A5;">CURDIR</span><span style="color: #036A07;">)/</span><span style="color: #036A07; font-weight: bold;">$</span><span style="color: #D0372D; font-weight: bold;">@</span><span style="color: #036A07;">' is NOT up to date$(</span><span style="color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>; exit 1; }
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_SUCCESS</span><span style=
"color: #036A07;">)\`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/</span><span style=
"color: #036A07; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span><span style=
"color: #036A07;">' successfully generated$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>

<span style="color: #0000ff; font-weight: bold;">$(</span><span style=
"color: #0000ff; font-weight: bold;">HTML_FILES_FROM_TXT</span><span style=
"color: #0000ff; font-weight: bold;">)</span>: %.html: %.txt   <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">Export an Org document to HTML</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_INFO</span><span style=
"color: #036A07;">)Exporting \`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/$</span><span style=
"color: #D0372D;">&lt;</span><span style=
"color: #036A07;">' to HTML...$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">ORG2HTML</span>) $<span style="color: #D0372D;">&lt;</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">LS</span>) -l -t $<span style=
"color: #D0372D;">&lt;</span> <span style=
"color: #0000ff; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span> | head -n 1 | grep -E <span style="color: #036A07;">"\.html"</span> &gt; /dev/null \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>|| { printf <span style="color: #036A07;">"$(</span><span style="color: #BA36A5;">C_FAILURE</span><span style="color: #036A07;">)\`$(</span><span style="color: #BA36A5;">CURDIR</span><span style="color: #036A07;">)/</span><span style="color: #036A07; font-weight: bold;">$</span><span style="color: #D0372D; font-weight: bold;">@</span><span style="color: #036A07;">' is NOT up to date$(</span><span style="color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>; exit 1; }
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_SUCCESS</span><span style=
"color: #036A07;">)\`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/</span><span style=
"color: #036A07; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span><span style=
"color: #036A07;">' successfully generated$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
</pre>
            </div>

            <p>The recipe to <b>convert Org to HTML</b> is:</p>

            <div class="org-src-container">
              <pre class="src src-makefile" id="recipe-convert-to-html">
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_INFO</span><span style=
"color: #036A07;">)Exporting \`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/$</span><span style=
"color: #D0372D;">&lt;</span><span style=
"color: #036A07;">' to HTML...$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">ORG2HTML</span>) $<span style="color: #D0372D;">&lt;</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">LS</span>) -l -t $<span style=
"color: #D0372D;">&lt;</span> <span style=
"color: #0000ff; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span> | head -n 1 | grep -E <span style="color: #036A07;">"\.html"</span> &gt; /dev/null \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>|| { printf <span style="color: #036A07;">"$(</span><span style="color: #BA36A5;">C_FAILURE</span><span style="color: #036A07;">)\`$(</span><span style="color: #BA36A5;">CURDIR</span><span style="color: #036A07;">)/</span><span style="color: #036A07; font-weight: bold;">$</span><span style="color: #D0372D; font-weight: bold;">@</span><span style="color: #036A07;">' is NOT up to date$(</span><span style="color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>; exit 1; }
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_SUCCESS</span><span style=
"color: #036A07;">)\`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/</span><span style=
"color: #036A07; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span><span style=
"color: #036A07;">' successfully generated$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
</pre>
            </div>

            <p>What about <code>org-export-as-html-batch</code> and
            <code>org-export-as-html-and-open</code>?</p>

            <div class="org-src-container">
              <pre class="src src-makefile">
<span style=
"color: #0000ff; font-weight: bold;">view-html</span>:                              <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Generate the HTML files, then show the result</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-8-1-6" class="outline-4">
          <h4 id="sec-8-1-6"><span class="section-number-4">8.1.6</span>
          PDF</h4>

          <div class="outline-text-4" id="text-8-1-6">
            <p><code>orgmk pdf</code> will find out which PDF files have to be
            regenerated, and will regenerate all of them.</p>

            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: pdf
<span style="color: #0000ff; font-weight: bold;">pdf</span>: $(<span style=
"color: #BA36A5;">CUR_PDF_FILES</span>)                   <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">Regenerate all PDF documents from Org</span>
</pre>
            </div>

            <p>Type <code>orgmk file.pdf</code> to generate only the specified
            PDF file.</p>

            <div class="org-src-container">
              <pre class="src src-makefile">
<span style=
"color: #0000ff; font-weight: bold;">$(PDF_FILES_FROM_ORG)</span>: %.pdf: %.org     <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Export an Org document to PDF</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_INFO</span><span style=
"color: #036A07;">)Exporting \`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/$</span><span style=
"color: #D0372D;">&lt;</span><span style=
"color: #036A07;">' to PDF...$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">ORG2PDF</span>) $<span style="color: #D0372D;">&lt;</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">LS</span>) -l -t $<span style=
"color: #D0372D;">&lt;</span> <span style=
"color: #0000ff; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span> | head -n 1 | grep -E <span style="color: #036A07;">"\.pdf"</span> &gt; /dev/null \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>|| { printf <span style="color: #036A07;">"$(</span><span style="color: #BA36A5;">C_FAILURE</span><span style="color: #036A07;">)\`$(</span><span style="color: #BA36A5;">CURDIR</span><span style="color: #036A07;">)/</span><span style="color: #036A07; font-weight: bold;">$</span><span style="color: #D0372D; font-weight: bold;">@</span><span style="color: #036A07;">' is NOT up to date$(</span><span style="color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>; exit 1; }
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_SUCCESS</span><span style=
"color: #036A07;">)\`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/</span><span style=
"color: #036A07; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span><span style=
"color: #036A07;">' successfully generated$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>

<span style="color: #0000ff; font-weight: bold;">$(</span><span style=
"color: #0000ff; font-weight: bold;">PDF_FILES_FROM_TXT</span><span style=
"color: #0000ff; font-weight: bold;">)</span>: %.pdf: %.txt     <span style=
"color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">Export an Org document to PDF</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_INFO</span><span style=
"color: #036A07;">)Exporting \`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/$</span><span style=
"color: #D0372D;">&lt;</span><span style=
"color: #036A07;">' to PDF...$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">ORG2PDF</span>) $<span style="color: #D0372D;">&lt;</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">LS</span>) -l -t $<span style=
"color: #D0372D;">&lt;</span> <span style=
"color: #0000ff; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span> | head -n 1 | grep -E <span style="color: #036A07;">"\.pdf"</span> &gt; /dev/null \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>|| { printf <span style="color: #036A07;">"$(</span><span style="color: #BA36A5;">C_FAILURE</span><span style="color: #036A07;">)\`$(</span><span style="color: #BA36A5;">CURDIR</span><span style="color: #036A07;">)/</span><span style="color: #036A07; font-weight: bold;">$</span><span style="color: #D0372D; font-weight: bold;">@</span><span style="color: #036A07;">' is NOT up to date$(</span><span style="color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>; exit 1; }
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_SUCCESS</span><span style=
"color: #036A07;">)\`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/</span><span style=
"color: #036A07; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span><span style=
"color: #036A07;">' successfully generated$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
</pre>
            </div>

            <div class="note">
              <p>The drawback of updating the dblocks inside the the recipes
              for HTML and PDF means that, if we have a file that’s
              <b>converted to both file formats</b>, the update will be done
              twice (so, once at least for nothing): once for HTML, then once
              again for PDF. Though, this case is quite uncommon.</p>
            </div>

            <p>The recipe to <b>convert Org to PDF</b> is:</p>

            <div class="org-src-container">
              <pre class="src src-makefile" id="recipe-convert-to-pdf">
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_INFO</span><span style=
"color: #036A07;">)Exporting \`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/$</span><span style=
"color: #D0372D;">&lt;</span><span style=
"color: #036A07;">' to PDF...$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">ORG2PDF</span>) $<span style="color: #D0372D;">&lt;</span>
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">LS</span>) -l -t $<span style=
"color: #D0372D;">&lt;</span> <span style=
"color: #0000ff; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span> | head -n 1 | grep -E <span style="color: #036A07;">"\.pdf"</span> &gt; /dev/null \
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>|| { printf <span style="color: #036A07;">"$(</span><span style="color: #BA36A5;">C_FAILURE</span><span style="color: #036A07;">)\`$(</span><span style="color: #BA36A5;">CURDIR</span><span style="color: #036A07;">)/</span><span style="color: #036A07; font-weight: bold;">$</span><span style="color: #D0372D; font-weight: bold;">@</span><span style="color: #036A07;">' is NOT up to date$(</span><span style="color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>; exit 1; }
<span style=
"color: #d3d3d3; background-color: #f5f5dc;">        </span>$(<span style=
"color: #BA36A5;">PRINTF</span>) <span style=
"color: #036A07;">"$(</span><span style=
"color: #BA36A5;">C_SUCCESS</span><span style=
"color: #036A07;">)\`$(</span><span style=
"color: #BA36A5;">CURDIR</span><span style=
"color: #036A07;">)/</span><span style=
"color: #036A07; font-weight: bold;">$</span><span style=
"color: #D0372D; font-weight: bold;">@</span><span style=
"color: #036A07;">' successfully generated$(</span><span style=
"color: #BA36A5;">C_RESET</span><span style="color: #036A07;">)\n"</span>
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>Export as LaTeX?</b><br />

                  <p>Maybe the export should be done to TeX, and then call (the
                  minimum number of times) PDFLaTeX from the
                  <code>orgmk.mk</code>? Check out if this is as robust as
                  using Org to build the PDF… (which goes on, even with some
                  errors occurring)</p>
                </td>
              </tr>
            </table>

            <p>I’ve observed cases where <code>orgmk pdf</code> was reporting
            that “Exporting to PDF…done”, but I was left with the previous PDF
            file. Hence, every call to <code>orgmk</code> tried to redo
            them…</p>

            <p>On deleting the PDF, and relaunching <code>orgmk</code> on that
            file, I had an error during the “Processing LaTeX file”.</p>

            <p>Workaround, to be sure that an old PDF does not stay in the way,
            remove the PDF output upon startup of the recipe. The TeX file was
            well updated. Hence, no need to delete it at startup…</p>

            <p><b>Problem</b>: when the PDF file is not generated anymore, it
            won’t be remade with <code>orgmk pdf</code>. We then have to
            explicitly <code>orgmk file.pdf</code>.</p>
          </div>
        </div>

        <div id="outline-container-sec-8-1-7" class="outline-4">
          <h4 id="sec-8-1-7"><span class="section-number-4">8.1.7</span>
          Clean</h4>

          <div class="outline-text-4" id="text-8-1-7">
            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #0000ff; font-weight: bold;">.PHONY</span>: clean
<span style=
"color: #0000ff; font-weight: bold;">clean</span>:                                  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Delete all temporary files created by Org export</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-8-1-8" class="outline-4">
          <h4 id="sec-8-1-8"><span class="section-number-4">8.1.8</span>
          <span class="todo TODO">TODO</span> Orgmk init file</h4>

          <div class="outline-text-4" id="text-8-1-8">
            <p>Here, we should <b>make a symlink</b>, if it does not exist yet.
            Would then be used just once…</p>

            <p>The only thing that’s not done yet automatically is: tangling
            this file!</p>
          </div>
        </div>

        <div id="outline-container-sec-8-1-9" class="outline-4">
          <h4 id="sec-8-1-9"><span class="section-number-4">8.1.9</span>
          Footer</h4>

          <div class="outline-text-4" id="text-8-1-9">
            <div class="org-src-container">
              <pre class="src src-makefile">
<span style="color: #8D8D84;">### </span><span style=
"color: #8D8D84; font-style: italic;">orgmk.mk ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-8-2" class="outline-3">
        <h3 id="sec-8-2"><span class="section-number-3">8.2</span> Makefile
        wrapper</h3>

        <div class="outline-text-3" id="text-8-2">
          <p>As you could want to run the batch scripts from a (development)
          directory where there is already a <code>Makefile</code>, you must
          install the <code>Makefile</code> under a different name:
          <code>orgmk.mk</code>.</p>

          <p>An addition is to create a symbolic link to the
          <code>orgmk.mk</code> into the directory of your Org files just for
          the duration of the script execution (on-the-fly install). The links
          can be safely removed after <code>make</code> has been run.</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #006699;">Usage</span> ()
{
    cat &lt;&lt; EOF 1&gt;&amp;2
<span style=
"color: #0000ff; background-color: #EEF5FE;">Usage: $(basename $0) [OPTION] FILE</span>
<span style=
"color: #0000ff; background-color: #EEF5FE;">Export Org source files whenever they are updated.</span>

<span style=
"color: #0000ff; background-color: #EEF5FE;">  -h, --help          display this help and exit</span>
<span style=
"color: #0000ff; background-color: #EEF5FE;">  -r, --recursive     export all Org files under each directory, recursively</span>

<span style=
"color: #0000ff; background-color: #EEF5FE;">Report $(basename $0) bugs to fni@missioncriticalit.com</span>
<span style="color: #0000ff; background-color: #EEF5FE;">EOF</span>
    <span style="color: #0000FF;">exit</span> 1
}
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #006699;">CleanUp</span> ()
{
    <span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">remove the Makefile</span>
    rm orgmk.mk
}

<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">perform housekeeping on program exit or a variety of signals</span>
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">(EXIT, HUP, INT, QUIT, TERM)</span>
<span style="color: #0000FF;">trap</span> CleanUp 0 1 2 3 15
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-sh">
<span style="color: #8D8D84;"># </span><span style=
"color: #8D8D84; font-style: italic;">install the Makefile where you are</span>
orgmk-stow-orgmk.mk

<span style="color: #BA36A5;">FLAGS</span>=<span style=
"color: #036A07;">""</span>
<span style="color: #0000FF;">while </span><span style=
"color: #006FE0;">true</span>; <span style="color: #0000FF;">do</span>
    <span style="color: #0000FF;">case</span> <span style=
"color: #036A07;">"$1"</span><span style="color: #0000FF;"> in</span>
        -h | --help ) Usage ;;
        -r | --recursive) <span style=
"color: #BA36A5;">FLAGS</span>=<span style=
"color: #036A07;">"ALLSUBDIRS=yes"</span>; <span style=
"color: #006FE0;">shift</span> ;;
        * ) <span style="color: #0000FF;">break</span> ;;
    <span style="color: #0000FF;">esac</span>
<span style="color: #0000FF;">done</span>

make -f orgmk.mk $<span style="color: #BA36A5;">FLAGS</span> $<span style=
"color: #BA36A5;">*</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-9" class="outline-2">
      <h2 id="sec-9"><span class="section-number-2">9</span> Orgmk
      configuration file</h2>

      <div class="outline-text-2" id="text-9">
        <p>I use a setup file <code>orgmk.el</code> to hold minimal
        customization.</p>

        <div class="info">
          <p>In batch mode, […] Emacs functions that normally print a message
          in the echo area will print to either the standard output stream
          (<code>stdout</code>) or the standard error stream
          (<code>stderr</code>) instead. (To be precise, functions like
          <code>prin1</code>, <code>princ</code> and <code>print</code> print
          to <code>stdout</code>, while <code>message</code> and
          <code>error</code> print to <code>stderr</code>.)</p>
        </div>
      </div>

      <div id="outline-container-sec-9-1" class="outline-3">
        <h3 id="sec-9-1"><span class="section-number-3">9.1</span> Common</h3>

        <div class="outline-text-3" id="text-9-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;;; </span><span style=
"color: #8D8D84; font-style: italic;">orgmk.el --- Emacs configuration file for `</span><span style="color: #D0372D; font-style: italic;">orgmk</span><span style="color: #8D8D84; font-style: italic;">'</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-9-1-1" class="outline-4">
          <h4 id="sec-9-1-1"><span class="section-number-4">9.1.1</span>
          Library Search</h4>

          <div class="outline-text-4" id="text-9-1-1">
            <p>Remember current directory.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">remember this directory</span>
(<span style="color: #0000FF;">defconst</span> <span style=
"color: #BA36A5;">orgmk-el-directory</span>
  (file-name-directory (or load-file-name (buffer-file-name)))
  <span style="color: #008000;">"Directory path of Orgmk."</span>)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-2" class="outline-4">
          <h4 id="sec-9-1-2"><span class="section-number-4">9.1.2</span>
          Feedback</h4>

          <div class="outline-text-4" id="text-9-1-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">;; activate debugging</span>
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">(setq debug-on-</span><span style=
"color: #CC0000; background-color: #FFFF88; font-style: italic;">error</span><span style="color: #8D8D84; font-style: italic;"> t)</span>

<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">no limit when printing values</span>
(setq eval-expression-print-length nil)
(setq eval-expression-print-level nil)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-3" class="outline-4">
          <h4 id="sec-9-1-3"><span class="section-number-4">9.1.3</span> Auto
          Save</h4>

          <div class="outline-text-4" id="text-9-1-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">don't make a backup of files</span>
(setq backup-inhibited t)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-4" class="outline-4">
          <h4 id="sec-9-1-4"><span class="section-number-4">9.1.4</span>
          Initialization for MS Windows</h4>

          <div class="outline-text-4" id="text-9-1-4">
            <p>When running an native Microsoft Windows version of Emacs:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">;; let Emacs recognize Cygwin paths (e.g. /usr/local/lib)</span>
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">(add-to-list 'load-path "~/Downloads/emacs/site-lisp") ;; &lt;- adjust</span>
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">(when (eq system-type 'windows-nt)</span>
<span style="color: #8D8D84;">;;   </span><span style=
"color: #8D8D84; font-style: italic;">(when (try-require 'cygwin-mount)</span>
<span style="color: #8D8D84;">;;     </span><span style=
"color: #8D8D84; font-style: italic;">(cygwin-mount-activate)))</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-5" class="outline-4">
          <h4 id="sec-9-1-5"><span class="section-number-4">9.1.5</span>
          Shell</h4>

          <div class="outline-text-4" id="text-9-1-5">
            <p>Fix the shell to use: the <b>default value of
            shell-file-name</b> (that is the program <code>/bin/bash</code>) is
            not found under Windows Emacs.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">shell</span>
(message <span style="color: #036A07;">"Current value of `</span><span style=
"color: #D0372D;">shell-file-name</span><span style=
"color: #036A07;">': %s"</span> shell-file-name)
(<span style=
"color: #0000FF;">unless</span> (equal shell-file-name <span style="color: #036A07;">"bash"</span>)
  (setq shell-file-name <span style="color: #036A07;">"bash"</span>)
  (message <span style=
"color: #036A07;">"... changed to: %s"</span> shell-file-name))
</pre>
            </div>

            <p>This is important when launching external tools, such as
            <code>PDFLaTeX</code> or <code>Latexmk</code>.</p>
          </div>
        </div>

        <div id="outline-container-sec-9-1-6" class="outline-4">
          <h4 id="sec-9-1-6"><span class="section-number-4">9.1.6</span>
          Installation of version 8 or later</h4>

          <div class="outline-text-4" id="text-9-1-6">
            <p>Ensure that a recent version of Org mode is installed and
            loaded.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
(<span style="color: #0000FF;">when</span> (locate-library <span style=
"color: #036A07;">"package"</span>)
  (<span style="color: #0000FF;">require</span> '<span style=
"color: #D0372D;">package</span>)
  (add-to-list 'package-archives '(<span style=
"color: #036A07;">"org"</span> . <span style=
"color: #036A07;">"http://orgmode.org/elpa/"</span>))
  (add-to-list 'package-archives '(<span style=
"color: #036A07;">"melpa"</span> . <span style=
"color: #036A07;">"http://melpa.milkbox.net/packages/"</span>))
  (package-initialize))

<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">version info</span>
(<span style=
"color: #0000FF;">let</span> ((org-install-dir (file-name-directory (locate-library <span style="color: #036A07;">"org-loaddefs"</span>)))
      (org-dir (file-name-directory (locate-library <span style=
"color: #036A07;">"org"</span>)))) <span style=
"color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">org.(el|elc)</span>
  (message <span style=
"color: #036A07;">"Org mode version %s (org @ %s)"</span>
           (org-version)
           (<span style=
"color: #0000FF;">if</span> (string= org-dir org-install-dir)
               org-install-dir
             (concat <span style=
"color: #036A07;">"mixed installation! "</span> org-install-dir <span style=
"color: #036A07;">" and "</span> org-dir))))

(<span style="color: #0000FF;">unless</span> (string-match <span style=
"color: #036A07;">"^8"</span> (org-version))
  (message <span style=
"color: #036A07;">"This version of Org mode is no longer supported"</span>)
  (<span style="color: #0000FF;">when</span> (locate-library <span style=
"color: #036A07;">"package"</span>)
    (<span style="color: #0000FF;">if</span> (yes-or-no-p (format <span style=
"color: #036A07;">"Install package `</span><span style=
"color: #D0372D;">%s</span><span style="color: #036A07;">'? "</span> 'org))
        (<span style="color: #0000FF;">ignore-</span><span style=
"color: #CC0000; background-color: #FFFF88;">error</span><span style=
"color: #0000FF;">s</span>
          (package-install 'org))
      (setq debug-on-<span style=
"color: #CC0000; background-color: #FFFF88;">error</span> nil)
      (<span style=
"color: #CC0000; background-color: #FFFF88; font-weight: bold;">error</span> <span style="color: #036A07;">"Please upgrade to 8 or later"</span>))))

(<span style="color: #0000FF;">when</span> (locate-library <span style=
"color: #036A07;">"package"</span>)
  (<span style="color: #0000FF;">unless</span> (locate-library <span style=
"color: #036A07;">"htmlize"</span>)    <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">for org2html</span>
    (<span style="color: #0000FF;">let</span> ((pkg 'htmlize))
      (<span style=
"color: #0000FF;">if</span> (yes-or-no-p (format <span style="color: #036A07;">"Install package `</span><span style="color: #D0372D;">%s</span><span style="color: #036A07;">'? "</span> pkg))
          (<span style="color: #0000FF;">ignore-</span><span style=
"color: #CC0000; background-color: #FFFF88;">error</span><span style=
"color: #0000FF;">s</span>
            (package-install pkg))))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-7" class="outline-4">
          <h4 id="sec-9-1-7"><span class="section-number-4">9.1.7</span>
          Activation</h4>

          <div class="outline-text-4" id="text-9-1-7">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
(add-to-list 'auto-mode-alist '(<span style=
"color: #036A07;">"\\.txt\\'"</span> . org-mode))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-8" class="outline-4">
          <h4 id="sec-9-1-8"><span class="section-number-4">9.1.8</span>
          Language Environment</h4>

          <div class="outline-text-4" id="text-9-1-8">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">make sure that timestamps appear in English</span>
(setq system-time-locale <span style=
"color: #036A07;">"C"</span>)           <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">[default: nil]</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-9" class="outline-4">
          <h4 id="sec-9-1-9"><span class="section-number-4">9.1.9</span> Clock
          table</h4>

          <div class="outline-text-4" id="text-9-1-9">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">format string used when creating CLOCKSUM lines and when generating a</span>
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">time duration (avoid showing days)</span>
(setq org-time-clocksum-format
      '(<span style="color: #006FE0;">:hours</span> <span style=
"color: #036A07;">"%d"</span> <span style=
"color: #006FE0;">:require-hours</span> t <span style=
"color: #006FE0;">:minutes</span> <span style=
"color: #036A07;">":%02d"</span> <span style=
"color: #006FE0;">:require-minutes</span> t))

<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">format string for the total time cells</span>
(setq org-clock-total-time-cell-format <span style=
"color: #036A07;">"%s"</span>)

<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">format string for the file time cells</span>
(setq org-clock-file-time-cell-format <span style=
"color: #036A07;">"%s"</span>)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-10" class="outline-4">
          <h4 id="sec-9-1-10"><span class="section-number-4">9.1.10</span>
          Markup</h4>

          <div class="outline-text-4" id="text-9-1-10">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">hide the emphasis marker characters</span>
(setq org-hide-emphasis-markers t)      <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">impact on table alignment!</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-11" class="outline-4">
          <h4 id="sec-9-1-11"><span class="section-number-4">9.1.11</span>
          Export options</h4>

          <div class="outline-text-4" id="text-9-1-11">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">allow #+BIND to define local variable values for export</span>
(setq org-export-allow-bind-keywords t)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-12" class="outline-4">
          <h4 id="sec-9-1-12"><span class="section-number-4">9.1.12</span>
          Org-Babel</h4>

          <div class="outline-text-4" id="text-9-1-12">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">configure Babel to support most languages</span>
(<span style="color: #0000FF;">if</span> (locate-library <span style=
"color: #036A07;">"ob-shell"</span>)         <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">ob-sh renamed on Dec 13th, 2013</span>
    (org-babel-do-load-languages        <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">loads org, gnus-sum, etc...</span>
     'org-babel-load-languages
     '((R          . t)                 <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">requires R and ess-mode</span>
       (awk        . t)
       (ditaa      . t)                 <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">sudo aptitude install openjdk-6-jre</span>
       (dot        . t)
       (emacs-lisp . t)
       (latex      . t)                 <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">shouldn't you use #+begin/end_latex blocks instead?</span>
       (ledger     . t)                 <span style=
"color: #8D8D84;">; </span><span style=
"color: #8D8D84; font-style: italic;">requires ledger</span>
       (org        . t)
       (shell      . t)
       (sql        . t)))
  <span style="color: #8D8D84;">;; </span><span style=
"color: #CC0000; background-color: #FFFF88; font-style: italic;">XXX</span><span style="color: #8D8D84; font-style: italic;"> (in the future) message saying "Upgrade to Org 8.3"</span>
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((R          . t)
     (awk        . t)
     (ditaa      . t)
     (dot        . t)
     (emacs-lisp . t)
     (latex      . t)
     (ledger     . t)
     (org        . t)
     (sh         . t)
     (sql        . t))))

<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">accented characters on graphics</span>
(setq org-babel-R-command
      (concat org-babel-R-command <span style=
"color: #036A07;">" --encoding=UTF-8"</span>))

<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">don't require confirmation before evaluating code blocks</span>
(setq org-confirm-babel-evaluate nil)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-9-1-13" class="outline-4">
          <h4 id="sec-9-1-13"><span class="section-number-4">9.1.13</span>
          Library of Babel</h4>

          <div class="outline-text-4" id="text-9-1-13">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">load up Babel libraries</span>
(<span style=
"color: #0000FF;">let</span> ((lob-file (concat (file-name-directory (locate-library <span style="color: #036A07;">"org"</span>))
                        <span style=
"color: #036A07;">"../doc/library-of-babel.org"</span>)))
  (<span style="color: #0000FF;">when</span> (file-exists-p lob-file)
    (org-babel-lob-ingest lob-file)))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-9-2" class="outline-3">
        <h3 id="sec-9-2"><span class="section-number-3">9.2</span> HTML
        export</h3>

        <div class="outline-text-3" id="text-9-2">
          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%">
                <b>Understand the hidden xx used for spacing levels in column
                views</b><br />

                <p>Depending on interactive vs batch export to HTML, we still
                have the above difference in the resulting HTML file.</p>
              </td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(<span style="color: #0000FF;">when</span> (<span style=
"color: #0000FF;">require</span> '<span style="color: #D0372D;">ox-html</span>)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">XML encoding</span>
  (setq org-html-xml-declaration
        '((<span style="color: #036A07;">"html"</span> . <span style=
"color: #036A07;">"&lt;!-- &lt;xml version=\"1.0\" encoding=\"%s\"&gt; --&gt;"</span>)))

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">don't include the JavaScript snippets in exported HTML files</span>
  (setq org-html-head-include-scripts nil)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">turn inclusion of the default CSS style off</span>
  (setq org-html-head-include-default-style nil)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">coding system for HTML export</span>
  (setq org-html-coding-system 'utf-8)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">format for the HTML postamble</span>
  (setq org-html-postamble
        <span style=
"color: #036A07;">"  &lt;div id=\"copyright\"&gt;\n    &amp;copy; %d %a\n  &lt;/div&gt;"</span>)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #CC0000; background-color: #FFFF88; font-style: italic;">XXX</span><span style="color: #8D8D84; font-style: italic;"> export the CSS selectors only, when formatting code snippets</span>
  (setq org-export-htmlize-output-type 'css))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-9-3" class="outline-3">
        <h3 id="sec-9-3"><span class="section-number-3">9.3</span> PDF LaTeX
        export</h3>

        <div class="outline-text-3" id="text-9-3">
          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Since <span class=
              "timestamp-wrapper"><span class="timestamp">[2012-10-26
              Fri]</span></span>, the %b now means the real base name (no full
              part).</b><br /></td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(<span style="color: #0000FF;">when</span> (<span style=
"color: #0000FF;">require</span> '<span style=
"color: #D0372D;">ox-latex</span>)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">;; This is disturbing when calling `</span><span style="color: #D0372D; font-style: italic;">org2html</span><span style="color: #8D8D84; font-style: italic;">'.</span>
  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">(when (executable-find "latexmk")</span>
  <span style="color: #8D8D84;">;;   </span><span style=
"color: #8D8D84; font-style: italic;">(message "%s" (shell-command-to-string "latexmk --version")))</span>

  (setq org-latex-pdf-process
        (<span style=
"color: #0000FF;">if</span> (eq system-type 'cygwin) <span style=
"color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">running a Cygwin version of Emacs</span>
            <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">use Latexmk (if installed with LaTeX)</span>
            (<span style=
"color: #0000FF;">if</span> (executable-find <span style=
"color: #036A07;">"latexmk"</span>)
                '(<span style=
"color: #036A07;">"latexmk -CF -pdf $(cygpath -m %f) &amp;&amp; latexmk -c"</span>)
              '(<span style=
"color: #036A07;">"pdflatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>
                <span style=
"color: #036A07;">"pdflatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>
                <span style=
"color: #036A07;">"pdflatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>))
          (<span style=
"color: #0000FF;">if</span> (executable-find <span style="color: #036A07;">"latexmk"</span>)
              '(<span style=
"color: #036A07;">"latexmk -CF -pdf %f &amp;&amp; latexmk -c"</span>)
            '(<span style=
"color: #036A07;">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>
              <span style=
"color: #036A07;">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>
              <span style=
"color: #036A07;">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>))))

  (message <span style=
"color: #036A07;">"LaTeX command: %S"</span> org-latex-pdf-process)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">tell org to use `</span><span style=
"color: #D0372D; font-style: italic;">listings</span><span style=
"color: #8D8D84; font-style: italic;">' (instead of `</span><span style=
"color: #D0372D; font-style: italic;">verbatim</span><span style=
"color: #8D8D84; font-style: italic;">') for source code</span>
  (setq org-latex-listings t)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">default packages to be inserted in the header</span>
  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">include the `</span><span style=
"color: #D0372D; font-style: italic;">listings</span><span style=
"color: #8D8D84; font-style: italic;">' package for fontified source code</span>
  (add-to-list 'org-latex-packages-alist '(<span style=
"color: #036A07;">""</span> <span style="color: #036A07;">"listings"</span>) t)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">include the `</span><span style=
"color: #D0372D; font-style: italic;">xcolor</span><span style=
"color: #8D8D84; font-style: italic;">' package for colored source code</span>
  (add-to-list 'org-latex-packages-alist '(<span style=
"color: #036A07;">""</span> <span style="color: #036A07;">"xcolor"</span>) t)

  <span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">default position for LaTeX figures</span>
  (setq org-latex-default-figure-position <span style=
"color: #036A07;">"!htbp"</span>))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-9-4" class="outline-3">
        <h3 id="sec-9-4"><span class="section-number-3">9.4</span> Extra
        customization files</h3>

        <div class="outline-text-3" id="text-9-4">
          <p>To allow you to easily add extra settings to the above “standard”
          ones, you can create several files in the <code>lisp</code>
          directory. All of them will be loaded at the end of
          <code>orgmk</code>’s initialization.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style=
"color: #8D8D84; font-style: italic;">require all files from `</span><span style="color: #D0372D; font-style: italic;">lisp</span><span style="color: #8D8D84; font-style: italic;">' directory</span>
(<span style="color: #0000FF;">dolist</span> (file (directory-files
               (concat orgmk-el-directory <span style=
"color: #036A07;">"../lisp/"</span>) t <span style=
"color: #036A07;">".+\\.elc?$"</span>))
  (load-file file))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;;; </span><span style=
"color: #8D8D84; font-style: italic;">orgmk.el ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-10" class="outline-2">
      <h2 id="sec-10"><span class="section-number-2">10</span> Sample
      parameters</h2>

      <div class="outline-text-2" id="text-10"></div>

      <div id="outline-container-sec-10-1" class="outline-3">
        <h3 id="sec-10-1"><span class="section-number-3">10.1</span> Custom
        LaTeX classes</h3>

        <div class="outline-text-3" id="text-10-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;;; </span><span style=
"color: #8D8D84; font-style: italic;">org-latex-classes.el --- Sample configuration file for LaTeX</span>

(add-to-list 'org-latex-classes
             '(<span style="color: #036A07;">"koma-article"</span>
               <span style="color: #036A07;">"\\documentclass{scrartcl}</span>
<span style="color: #036A07;">               [NO-DEFAULT-PACKAGES]</span>
<span style="color: #036A07;">               [EXTRA]"</span>
               (<span style=
"color: #036A07;">"\\section{%s}"</span> . <span style=
"color: #036A07;">"\\section*{%s}"</span>)
               (<span style=
"color: #036A07;">"\\subsection{%s}"</span> . <span style=
"color: #036A07;">"\\subsection*{%s}"</span>)
               (<span style=
"color: #036A07;">"\\subsubsection{%s}"</span> . <span style=
"color: #036A07;">"\\subsubsection*{%s}"</span>)
               (<span style=
"color: #036A07;">"\\paragraph{%s}"</span> . <span style=
"color: #036A07;">"\\paragraph*{%s}"</span>)
               (<span style=
"color: #036A07;">"\\subparagraph{%s}"</span> . <span style=
"color: #036A07;">"\\subparagraph*{%s}"</span>)))

<span style="color: #8D8D84;">;;; </span><span style=
"color: #8D8D84; font-style: italic;">org-latex-classes.el ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-11" class="outline-2">
      <h2 id="sec-11"><span class="section-number-2">11</span> Standard
      disclaimer</h2>

      <div class="outline-text-2" id="text-11">
        <p>I am furnishing this item “as is”. I do <b>NOT</b> provide <b>ANY
        WARRANTY</b> of the item whatsoever, whether express, implied, or
        statutory, including, but not limited to, any warranty of
        <b>MERCHANTABILITY</b> or <b>FITNESS FOR A PARTICULAR PURPOSE</b> or
        any warranty that the contents of the item will be error-free.</p>

        <p>In no respect shall I incur any liability for any damages,
        including, but limited to, direct, indirect, special, or consequential
        damages arising out of, resulting from, or any way connected to the use
        of the item, whether or not based upon warranty, contract, tort, or
        otherwise; whether or not injury was sustained by persons or property
        or otherwise; and whether or not loss was sustained from, or arose out
        of, the results of, the item, or any services that may be provided by
        me.</p>
      </div>
    </div>
  </div>

  <div id="postamble" class="status">
    <div id="footer">
      <div id="copyright">
        Copyright © Fabrice Niessen
      </div>
    </div>
  </div>
</body>
</html>
